#+BEGIN_COMMENT
.. title: Card Network
.. slug: card-network
.. date: 2020-05-24 23:36:12 UTC+01:00
.. tags: programming, machine-learning
.. category:
.. link:
.. description: A tiny neural network in c++
.. type: text
#+END_COMMENT

* Testing!
this is

#+BEGIN_SRC cpp
#include <bits/stdc++.h>

#define f float
#define v std::vector<f>
f K=0.01,R=0.01; // relu leak, learning rate

struct L{int w,h,i;v W,x,z;L(int i,int o){
w=i;h=o;W.resize(w*h);for(f&a:W)a=(rand()/
(1.1-(1<<31))-0.5)/sqrt(w+h+0.);}v fr(v nx
){x=nx;v a(h);i=h*w;while(i--)a[i/w]+=W[i]
*x[i%w];z=a;for(f&i:a)i=K>i?K:i;return a;}
v bk(v dy){v dx(w);i=w*h;while(i--){f dz=
dy[i/w]*(z[i/w]>0?1:K);dx[i%w]+=dz*W[i];W[
i]-=R*dz*x[i%w];}return dx;}};int main(){L
n[]{L(40,50),L(50,50),L(50,1)};int l,z,k,i
=500336;while(i--){z=242-i%243;k=40;v x(k)
,y;while(k--)x[k]=sin((k%2?z/27/3.:z%27/5.
)+6.14*k/20);y=x;for(l=0;l<3;l++)y=n[l].fr
(y);v dy{2*(y[0]-("\x1e\0\0\b\x01\0@H\374\
\377B\x12@\x18\x12G\302\x10@\x12\372\377\
\221\x10\0\0\200\0\0\0\x02"[z/8]>>z%8&1))}
;while(l--)dy=n[l].bk(dy);putchar(" .,-*o\
O##"[(int)(y[0]*8)%9]);if(i%27<1)puts(i?i%
243?"":"\033[9A":"\r   --- Oisin Carroll \
---\n gh:Oisincar  web:imois.in");}}
#+END_SRC




#+BEGIN_EXPORT html
<button>Run Code!</button>
<div class="monospace-code" id="div1">> ./card_network</div>

<script src="../assets/js/card_network/fk_network.js"></script>
#+END_EXPORT
